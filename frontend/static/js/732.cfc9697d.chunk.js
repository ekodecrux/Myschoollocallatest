"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[732],{33438(e,s,n){n.d(s,{A:()=>r});var t=n(66734),l=n(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},47968(e,s,n){n.d(s,{A:()=>r});var t=n(66734),l=n(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")},51387(e,s,n){n.d(s,{A:()=>r});var t=n(66734),l=n(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},70141(e,s,n){n.d(s,{A:()=>r});var t=n(66734),l=n(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},83560(e,s,n){n.d(s,{A:()=>r});var t=n(66734),l=n(70579);const r=(0,t.A)((0,l.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},99732(e,s,n){n.r(s),n.d(s,{default:()=>We});var t=n(89379),l=n(80045),r=n(65043),a=n(46946),i=n(94496),o=n(26487),c=n(8591),d=n(59314),h=n(98056),x=n(65204),m=n(19955),u=n(40360),A=n(59064),j=n(71861),p=n(66734),g=n(70579);const v=(0,p.A)((0,g.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-5h2zm4 0h-2v-3h2zm0-5h-2v-2h2zm4 5h-2V7h2z"}),"Analytics"),b=(0,p.A)((0,g.jsx)("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"}),"Business"),y=(0,p.A)((0,g.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People");var f=n(75475);const S=(0,p.A)((0,g.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"CreditCard");var C=n(68746);const z=(0,p.A)((0,g.jsx)("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"}),"AttachMoney"),_=(0,p.A)((0,g.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");var N=n(79456),k=n(56263);const w="https://portal.myschoolct.com",E=(e,s)=>{const[n,l]=(0,r.useState)({}),[a,i]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[x,m]=(0,r.useState)([]),[u,A]=(0,r.useState)([]),[j,p]=(0,r.useState)([]),[g,v]=(0,r.useState)(!1),b=(0,r.useCallback)(async()=>{try{const s=await k.A.get("".concat(w,"/api/admin/dashboard-stats"),{headers:{Authorization:"Bearer ".concat(e)}});l(s.data)}catch(s){console.error("Error fetching stats:",s)}},[e]),y=(0,r.useCallback)(async()=>{if("SUPER_ADMIN"===s)try{const s=await k.A.get("".concat(w,"/api/rest/schools/list?limit=500"),{headers:{Authorization:"Bearer ".concat(e)}}),n=(s.data.data||[]).map(e=>(0,t.A)((0,t.A)({},e),{},{code:e.schoolCode||e.code}));i(n)}catch(n){console.error("Error fetching schools:",n)}},[e,s]),f=(0,r.useCallback)(async()=>{if("SUPER_ADMIN"===s)try{const s=await k.A.get("".concat(w,"/api/rest/users/list?noSchoolCode=true"),{headers:{Authorization:"Bearer ".concat(e)}});m(s.data.users||s.data||[])}catch(n){console.error("Error fetching users without school:",n)}},[e,s]),S=(0,r.useCallback)(async()=>{try{var s,n;const t=await k.A.get("".concat(w,"/api/rest/users/listUsersByRole?role=TEACHER&limit=100"),{headers:{Authorization:"Bearer ".concat(e)}});c((null===(s=t.data)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.users)||[])}catch(t){console.error("Error fetching teachers:",t)}},[e]),C=(0,r.useCallback)(async()=>{try{var s,n;const t=await k.A.get("".concat(w,"/api/rest/users/listUsersByRole?role=STUDENT&limit=100"),{headers:{Authorization:"Bearer ".concat(e)}});h((null===(s=t.data)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.users)||[])}catch(t){console.error("Error fetching students:",t)}},[e]),z=(0,r.useCallback)(async()=>{if("SUPER_ADMIN"===s)try{const s=await k.A.get("".concat(w,"/api/rest/images/admin/getPendingApprovals"),{headers:{Authorization:"Bearer ".concat(e)}});A(s.data.images||[])}catch(n){console.error("Error fetching pending images:",n)}},[e,s]),_=(0,r.useCallback)(async()=>{if("SUPER_ADMIN"===s)try{var n;const s=await k.A.get("".concat(w,"/api/rest/users/creditRequests"),{headers:{Authorization:"Bearer ".concat(e)}});p((null===(n=s.data)||void 0===n?void 0:n.requests)||s.data||[])}catch(t){console.error("Error fetching credit requests:",t),p([])}},[e,s]),N=(0,r.useCallback)(async()=>{v(!0),await Promise.all([b(),y(),z(),_(),S(),C()]),v(!1)},[b,y,z,_,S,C]);return{stats:n,schools:a,teachers:o,students:d,usersWithoutSchool:x,pendingImages:u,creditRequests:j,loading:g,fetchStats:b,fetchSchools:y,fetchTeachers:S,fetchStudents:C,fetchUsersWithoutSchool:f,fetchPendingImages:z,fetchCreditRequests:_,fetchAllData:N}};var I=n(72882),U=n(42788),D=n(56894),W=n(60960),R=n(91068),T=n(42492),P=n(68738),M=n(39652),L=n(21832),B=n(70141);const F=(0,p.A)((0,g.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");var H=n(79484);const V=e=>{let{schools:s,onAddSchool:n,onBulkUpload:t}=e;const[l,i]=(0,r.useState)(""),c=s.filter(e=>{var s,n;return(null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes(l.toLowerCase()))||(null===(n=e.code)||void 0===n?void 0:n.toLowerCase().includes(l.toLowerCase()))}),d=(e,s)=>{const n=[e,s].filter(Boolean);return n.length>0?n.join(", "):"-"};return(0,g.jsxs)(a.A,{children:[(0,g.jsxs)(a.A,{sx:{mb:2,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[(0,g.jsx)(I.A,{variant:"contained",startIcon:(0,g.jsx)(B.A,{}),onClick:n,sx:{bgcolor:"#ec4899","&:hover":{bgcolor:"#db2777"}},children:"Add School"}),(0,g.jsx)(I.A,{variant:"outlined",startIcon:(0,g.jsx)(F,{}),onClick:()=>t("schools"),children:"Bulk Upload Schools"}),(0,g.jsx)(U.A,{size:"small",placeholder:"Search by school name or code...",value:l,onChange:e=>i(e.target.value),sx:{minWidth:250},InputProps:{startAdornment:(0,g.jsx)(D.A,{position:"start",children:(0,g.jsx)(H.A,{fontSize:"small"})})}})]}),(0,g.jsx)(W.A,{component:x.A,children:(0,g.jsxs)(R.A,{size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{sx:{bgcolor:"#f5f5f5"},children:[(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"School Code"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"School Name"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Principal Name"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Admin Email"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Location"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Status"})}),(0,g.jsx)(M.A,{align:"center",children:(0,g.jsx)("strong",{children:"Teachers"})}),(0,g.jsx)(M.A,{align:"center",children:(0,g.jsx)("strong",{children:"Students"})})]})}),(0,g.jsxs)(L.A,{children:[c.map(e=>(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.code,size:"small",color:"primary",variant:"outlined"})}),(0,g.jsx)(M.A,{children:e.name}),(0,g.jsx)(M.A,{children:e.principalName||e.principal_name||"-"}),(0,g.jsx)(M.A,{children:e.adminEmail||e.admin_email||"-"}),(0,g.jsx)(M.A,{children:d(e.city,e.state)}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:!1!==e.is_active?"Active":"Inactive",size:"small",color:!1!==e.is_active?"success":"error"})}),(0,g.jsx)(M.A,{align:"center",children:e.teachersEnrolled||e.teacher_count||0}),(0,g.jsx)(M.A,{align:"center",children:e.studentsEnrolled||e.student_count||0})]},e.id)),0===c.length&&(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:8,align:"center",children:l?"No schools found matching your search":"No schools found"})})]})]})}),(0,g.jsxs)(j.A,{severity:"info",sx:{mt:2},children:[(0,g.jsx)("strong",{children:"Note:"})," Each school admin will receive login credentials via email after creation."]})]})};var q=n(78632),O=n(17642),Q=n(17434),J=n(94814),$=n(69392),G=n(71716),K=n(83462),X=n(26600),Y=n(97368),Z=n(92064);const ee=(0,p.A)((0,g.jsx)("path",{d:"M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2zm-9-2h10V8H12zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"AccountBalanceWallet"),se=(0,p.A)((0,g.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block"),ne=(0,p.A)((0,g.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");var te=n(83560),le=n(51387);const re=e=>{var s;let{teachers:n,schools:l=[],userRole:i,searchQuery:c,searchResults:d,searchLoading:h,onSearch:m,onSearchChange:u,onBulkUpload:A,onEditUser:p,onDeleteUser:v,onToggleStatus:b,onManageCredits:y}=e;const[f,S]=(0,r.useState)(""),[C,z]=(0,r.useState)({open:!1,user:null,credits:0});let _=c.length>=2?d.filter(e=>"TEACHER"===e.role):n;f&&(_=_.filter(e=>e.schoolCode===f));const N=e=>{z({open:!0,user:e,credits:e.credits||0})},k=()=>{z({open:!1,user:null,credits:0})};return(0,g.jsxs)(a.A,{children:[(0,g.jsxs)(a.A,{sx:{mb:2,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[(0,g.jsx)(I.A,{variant:"outlined",startIcon:(0,g.jsx)(F,{}),onClick:()=>A("teachers"),sx:{"&:hover":{backgroundColor:"primary.main",color:"white"}},children:"Bulk Upload Teachers"}),"SUPER_ADMIN"===i&&l.length>0&&(0,g.jsxs)(q.A,{size:"small",sx:{minWidth:200},children:[(0,g.jsx)(O.A,{children:"Filter by School"}),(0,g.jsxs)(Q.A,{value:f,label:"Filter by School",onChange:e=>S(e.target.value),children:[(0,g.jsx)(J.A,{value:"",children:"All Schools"}),l.map(e=>(0,g.jsxs)(J.A,{value:e.code,children:[e.name," (",e.code,")"]},e.code))]})]})]}),(0,g.jsx)(U.A,{fullWidth:!0,placeholder:"Search by name, email, teacher code, school...",value:c,onChange:e=>{u(e.target.value),m(e.target.value)},sx:{mb:2},InputProps:{startAdornment:(0,g.jsx)(D.A,{position:"start",children:(0,g.jsx)(H.A,{sx:{color:"text.secondary"}})})}}),(0,g.jsx)(W.A,{component:x.A,sx:{maxHeight:500,overflow:"auto"},children:(0,g.jsxs)(R.A,{stickyHeader:!0,size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"School Code"})}),(0,g.jsx)(M.A,{sx:{minWidth:150},children:(0,g.jsx)("strong",{children:"School Name"})}),(0,g.jsx)(M.A,{sx:{minWidth:150},children:(0,g.jsx)("strong",{children:"Name"})}),(0,g.jsx)(M.A,{sx:{minWidth:180},children:(0,g.jsx)("strong",{children:"Email"})}),(0,g.jsx)(M.A,{sx:{minWidth:120},children:(0,g.jsx)("strong",{children:"Mobile"})}),(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Teacher Code"})}),(0,g.jsx)(M.A,{align:"center",sx:{minWidth:80},children:(0,g.jsx)("strong",{children:"Students"})}),(0,g.jsx)(M.A,{align:"center",sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Credits"})}),(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Status"})}),("SUPER_ADMIN"===i||"SCHOOL_ADMIN"===i)&&(0,g.jsx)(M.A,{sx:{minWidth:150},children:(0,g.jsx)("strong",{children:"Actions"})})]})}),(0,g.jsxs)(L.A,{children:[_.map(e=>(0,g.jsxs)(P.A,{sx:{opacity:e.disabled?.6:1,bgcolor:e.disabled?"#fff3f3":"inherit"},children:[(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.schoolCode||"-",size:"small",color:"secondary",variant:"outlined"})}),(0,g.jsx)(M.A,{children:e.schoolName||"-"}),(0,g.jsx)(M.A,{children:e.name}),(0,g.jsx)(M.A,{children:e.email}),(0,g.jsx)(M.A,{children:e.mobileNumber||e.mobile_number||"-"}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.teacherCode||e.teacher_code||"-",size:"small",color:"primary",variant:"outlined"})}),(0,g.jsx)(M.A,{align:"center",children:e.studentCount||e.student_count||0}),(0,g.jsx)(M.A,{align:"center",children:(0,g.jsx)(o.A,{label:e.credits||0,size:"small",color:"info",icon:(0,g.jsx)(ee,{fontSize:"small"}),onClick:()=>N(e),sx:{cursor:"pointer"}})}),(0,g.jsx)(M.A,{children:(0,g.jsx)($.A,{title:e.disabled?"Account Disabled - Click to Enable":"Account Active - Click to Disable",children:(0,g.jsx)(o.A,{icon:e.disabled?(0,g.jsx)(se,{fontSize:"small"}):(0,g.jsx)(ne,{fontSize:"small"}),label:e.disabled?"Disabled":"Active",size:"small",color:e.disabled?"error":"success",variant:"outlined",onClick:()=>b(e),sx:{cursor:"pointer"}})})}),("SUPER_ADMIN"===i||"SCHOOL_ADMIN"===i)&&(0,g.jsxs)(M.A,{children:[(0,g.jsx)($.A,{title:"Edit",children:(0,g.jsx)(G.A,{size:"small",onClick:()=>p(e),children:(0,g.jsx)(te.A,{fontSize:"small"})})}),(0,g.jsx)($.A,{title:"Manage Credits",children:(0,g.jsx)(G.A,{size:"small",color:"info",onClick:()=>N(e),children:(0,g.jsx)(ee,{fontSize:"small"})})}),(0,g.jsx)($.A,{title:"Delete",children:(0,g.jsx)(G.A,{size:"small",color:"error",onClick:()=>v(e),children:(0,g.jsx)(le.A,{fontSize:"small"})})})]})]},e.id)),0===_.length&&(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:10,align:"center",children:h?"Searching...":"No teachers found"})})]})]})}),(0,g.jsxs)(K.A,{open:C.open,onClose:k,maxWidth:"xs",fullWidth:!0,children:[(0,g.jsxs)(X.A,{children:["Manage Credits - ",null===(s=C.user)||void 0===s?void 0:s.name]}),(0,g.jsx)(Y.A,{children:(0,g.jsx)(U.A,{fullWidth:!0,type:"number",label:"Credits",value:C.credits,onChange:e=>z((0,t.A)((0,t.A)({},C),{},{credits:parseInt(e.target.value)||0})),sx:{mt:2},InputProps:{startAdornment:(0,g.jsx)(D.A,{position:"start",children:(0,g.jsx)(ee,{})})}})}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:k,children:"Cancel"}),(0,g.jsx)(I.A,{variant:"contained",onClick:()=>{y&&C.user&&y(C.user.id,C.credits),k()},children:"Save"})]})]}),(0,g.jsxs)(j.A,{severity:"info",sx:{mt:2},children:[(0,g.jsx)("strong",{children:"Bulk Upload:"})," Download template, fill details, and upload. Login credentials will be sent to each teacher's email."]})]})},ae=e=>{var s;let{students:n,schools:l=[],userRole:i,searchQuery:c,searchResults:d,searchLoading:h,onSearch:m,onSearchChange:u,onBulkUpload:A,onEditUser:p,onDeleteUser:v,onToggleStatus:b,onManageCredits:y}=e;const[f,S]=(0,r.useState)(""),[C,z]=(0,r.useState)({open:!1,user:null,credits:0});let _=c.length>=2?d.filter(e=>"STUDENT"===e.role):n;f&&(_=_.filter(e=>e.schoolCode===f));const N=e=>{z({open:!0,user:e,credits:e.credits||0})},k=()=>{z({open:!1,user:null,credits:0})};return(0,g.jsxs)(a.A,{children:[(0,g.jsxs)(a.A,{sx:{mb:2,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[(0,g.jsx)(I.A,{variant:"outlined",startIcon:(0,g.jsx)(F,{}),onClick:()=>A("students"),sx:{"&:hover":{backgroundColor:"primary.main",color:"white"}},children:"Bulk Upload Students"}),"SUPER_ADMIN"===i&&l.length>0&&(0,g.jsxs)(q.A,{size:"small",sx:{minWidth:200},children:[(0,g.jsx)(O.A,{children:"Filter by School"}),(0,g.jsxs)(Q.A,{value:f,label:"Filter by School",onChange:e=>S(e.target.value),children:[(0,g.jsx)(J.A,{value:"",children:"All Schools"}),l.map(e=>(0,g.jsxs)(J.A,{value:e.code,children:[e.name," (",e.code,")"]},e.code))]})]})]}),(0,g.jsx)(U.A,{fullWidth:!0,placeholder:"Search by name, email, student code, class, section, roll number...",value:c,onChange:e=>{u(e.target.value),m(e.target.value)},sx:{mb:2},InputProps:{startAdornment:(0,g.jsx)(D.A,{position:"start",children:(0,g.jsx)(H.A,{sx:{color:"text.secondary"}})})}}),(0,g.jsx)(W.A,{component:x.A,sx:{maxHeight:500,overflow:"auto"},children:(0,g.jsxs)(R.A,{stickyHeader:!0,size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"School Code"})}),(0,g.jsx)(M.A,{sx:{minWidth:150},children:(0,g.jsx)("strong",{children:"School Name"})}),(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Student Code"})}),(0,g.jsx)(M.A,{sx:{minWidth:150},children:(0,g.jsx)("strong",{children:"Name"})}),(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Teacher Code"})}),(0,g.jsx)(M.A,{sx:{minWidth:80},children:(0,g.jsx)("strong",{children:"Class"})}),(0,g.jsx)(M.A,{sx:{minWidth:80},children:(0,g.jsx)("strong",{children:"Section"})}),(0,g.jsx)(M.A,{sx:{minWidth:80},children:(0,g.jsx)("strong",{children:"Roll No"})}),(0,g.jsx)(M.A,{align:"center",sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Credits"})}),(0,g.jsx)(M.A,{sx:{minWidth:100},children:(0,g.jsx)("strong",{children:"Status"})}),("SUPER_ADMIN"===i||"SCHOOL_ADMIN"===i||"TEACHER"===i)&&(0,g.jsx)(M.A,{sx:{minWidth:150},children:(0,g.jsx)("strong",{children:"Actions"})})]})}),(0,g.jsxs)(L.A,{children:[_.map(e=>(0,g.jsxs)(P.A,{sx:{opacity:e.disabled?.6:1,bgcolor:e.disabled?"#fff3f3":"inherit"},children:[(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.schoolCode||e.school_code||"-",size:"small",color:"secondary",variant:"outlined"})}),(0,g.jsx)(M.A,{children:e.schoolName||e.school_name||"-"}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.studentCode||e.student_code||"-",size:"small",color:"info",variant:"outlined"})}),(0,g.jsx)(M.A,{children:e.name}),(0,g.jsx)(M.A,{children:e.teacherCode||e.teacher_code||"-"}),(0,g.jsx)(M.A,{children:e.className||e.class_name||"-"}),(0,g.jsx)(M.A,{children:e.sectionName||e.section_name||"-"}),(0,g.jsx)(M.A,{children:e.rollNumber||e.roll_number||"-"}),(0,g.jsx)(M.A,{align:"center",children:(0,g.jsx)(o.A,{label:e.credits||0,size:"small",color:"info",icon:(0,g.jsx)(ee,{fontSize:"small"}),onClick:()=>N(e),sx:{cursor:"pointer"}})}),(0,g.jsx)(M.A,{children:(0,g.jsx)($.A,{title:e.disabled?"Account Disabled - Click to Enable":"Account Active - Click to Disable",children:(0,g.jsx)(o.A,{icon:e.disabled?(0,g.jsx)(se,{fontSize:"small"}):(0,g.jsx)(ne,{fontSize:"small"}),label:e.disabled?"Disabled":"Active",size:"small",color:e.disabled?"error":"success",variant:"outlined",onClick:()=>b(e),sx:{cursor:"pointer"}})})}),("SUPER_ADMIN"===i||"SCHOOL_ADMIN"===i||"TEACHER"===i)&&(0,g.jsxs)(M.A,{children:[(0,g.jsx)($.A,{title:"Edit",children:(0,g.jsx)(G.A,{size:"small",onClick:()=>p(e),children:(0,g.jsx)(te.A,{fontSize:"small"})})}),(0,g.jsx)($.A,{title:"Manage Credits",children:(0,g.jsx)(G.A,{size:"small",color:"info",onClick:()=>N(e),children:(0,g.jsx)(ee,{fontSize:"small"})})}),(0,g.jsx)($.A,{title:"Delete",children:(0,g.jsx)(G.A,{size:"small",color:"error",onClick:()=>v(e),children:(0,g.jsx)(le.A,{fontSize:"small"})})})]})]},e.id)),0===_.length&&(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:11,align:"center",children:h?"Searching...":"No students found"})})]})]})}),(0,g.jsxs)(K.A,{open:C.open,onClose:k,maxWidth:"xs",fullWidth:!0,children:[(0,g.jsxs)(X.A,{children:["Manage Credits - ",null===(s=C.user)||void 0===s?void 0:s.name]}),(0,g.jsx)(Y.A,{children:(0,g.jsx)(U.A,{fullWidth:!0,type:"number",label:"Credits",value:C.credits,onChange:e=>z((0,t.A)((0,t.A)({},C),{},{credits:parseInt(e.target.value)||0})),sx:{mt:2},InputProps:{startAdornment:(0,g.jsx)(D.A,{position:"start",children:(0,g.jsx)(ee,{})})}})}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:k,children:"Cancel"}),(0,g.jsx)(I.A,{variant:"contained",onClick:()=>{y&&C.user&&y(C.user.id,C.credits),k()},children:"Save"})]})]}),(0,g.jsxs)(j.A,{severity:"info",sx:{mt:2},children:[(0,g.jsx)("strong",{children:"Bulk Upload:"})," Download template (includes teacher_code column), fill details, and upload. Students will be assigned to teachers based on teacher code."]})]})},ie=e=>{let{usersWithoutSchool:s,bulkSchoolCodeUpdates:n,onBulkSchoolCodeUpdate:t,onSchoolCodeChange:l}=e;return(0,g.jsxs)(a.A,{children:[(0,g.jsx)(j.A,{severity:"warning",sx:{mb:2},children:"These users registered without a school code. Assign them to a school using the input fields below."}),(0,g.jsx)(W.A,{component:x.A,children:(0,g.jsxs)(R.A,{size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{sx:{bgcolor:"#f5f5f5"},children:[(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Name"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Email"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Role"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Assign School Code"})})]})}),(0,g.jsxs)(L.A,{children:[s.map(e=>(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:e.name}),(0,g.jsx)(M.A,{children:e.email}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.role||e.userRole,size:"small",color:"primary",variant:"outlined"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)(U.A,{size:"small",placeholder:"Enter school code",value:n[e.id]||"",onChange:s=>l(e.id,s.target.value),sx:{width:150}})})]},e.id)),0===s.length&&(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:4,align:"center",children:"All users have school codes assigned"})})]})]})}),s.length>0&&(0,g.jsx)(I.A,{variant:"contained",onClick:t,disabled:0===Object.keys(n).length,sx:{mt:2,bgcolor:"#ec4899","&:hover":{bgcolor:"#db2777"}},children:"Update School Codes"})]})},oe=(0,p.A)((0,g.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");var ce=n(33438);const de=e=>{let{pendingImages:s,onApprove:n,onReject:t}=e;const[l,o]=r.useState(null),[c,d]=r.useState(!1),h=e=>{o(e),d(!0)};return(0,g.jsx)(a.A,{children:0===s.length?(0,g.jsx)(j.A,{severity:"info",children:"No pending image approvals"}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(W.A,{component:x.A,children:(0,g.jsxs)(R.A,{size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{sx:{bgcolor:"#f5f5f5"},children:[(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Preview"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Title/Name"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Submitted By"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Category"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Date"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Actions"})})]})}),(0,g.jsx)(L.A,{children:s.map(e=>(0,g.jsxs)(P.A,{hover:!0,sx:{cursor:"pointer"},children:[(0,g.jsx)(M.A,{onClick:()=>h(e),children:(0,g.jsx)("img",{src:e.url,alt:"Preview",style:{width:60,height:60,objectFit:"cover",borderRadius:4},onError:e=>{e.target.src="https://via.placeholder.com/60?text=No+Image"}})}),(0,g.jsx)(M.A,{onClick:()=>h(e),children:e.title||e.original_filename||e.filename||"Unnamed"}),(0,g.jsx)(M.A,{children:e.submitted_by_name||e.submittedBy||e.submitted_by_email||"-"}),(0,g.jsx)(M.A,{children:e.category||"-"}),(0,g.jsx)(M.A,{children:e.submitted_at||e.createdAt?new Date(e.submitted_at||e.createdAt).toLocaleDateString():"-"}),(0,g.jsxs)(M.A,{children:[(0,g.jsx)(I.A,{size:"small",variant:"contained",color:"success",onClick:()=>n(e.id),sx:{minWidth:32,mr:1},children:(0,g.jsx)(oe,{fontSize:"small"})}),(0,g.jsx)(I.A,{size:"small",variant:"contained",color:"error",onClick:()=>t(e.id),sx:{minWidth:32,backgroundColor:"#d32f2f",color:"#ffffff","&:hover":{backgroundColor:"#b71c1c",color:"#ffffff"}},children:(0,g.jsx)(ce.A,{fontSize:"small"})})]})]},e.id))})]})}),(0,g.jsxs)(K.A,{open:c,onClose:()=>d(!1),maxWidth:"md",fullWidth:!0,children:[(0,g.jsx)(Y.A,{sx:{textAlign:"center",p:3},children:l&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.A,{variant:"h6",sx:{mb:2},children:l.title||l.original_filename||l.filename||"Unnamed Image"}),(0,g.jsx)("img",{src:l.url,alt:l.title||"Preview",style:{maxWidth:"100%",maxHeight:"60vh",objectFit:"contain",borderRadius:8},onError:e=>{e.target.src="https://via.placeholder.com/400?text=Image+Not+Found"}}),(0,g.jsxs)(a.A,{sx:{mt:2},children:[(0,g.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["Submitted by: ",l.submitted_by_name||l.submitted_by_email||"Unknown"]}),(0,g.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["Category: ",l.category||"N/A"]}),l.description&&(0,g.jsxs)(i.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Description: ",l.description]})]})]})}),(0,g.jsxs)(Z.A,{sx:{justifyContent:"center",pb:3,gap:2},children:[(0,g.jsx)(I.A,{variant:"contained",color:"success",onClick:()=>{l&&(n(l.id),d(!1),o(null))},startIcon:(0,g.jsx)(oe,{}),sx:{minWidth:120},children:"Approve"}),(0,g.jsx)(I.A,{variant:"contained",onClick:()=>{l&&(t(l.id),d(!1),o(null))},startIcon:(0,g.jsx)(ce.A,{}),sx:{minWidth:120,backgroundColor:"#d32f2f",color:"#ffffff","&:hover":{backgroundColor:"#b71c1c",color:"#ffffff"}},children:"Reject"})]})]})]})})},he=e=>{let{creditRequests:s,onApprove:n,onReject:t}=e;return(0,g.jsx)(a.A,{children:0===s.length?(0,g.jsx)(j.A,{severity:"info",children:"No pending credit requests"}):(0,g.jsx)(W.A,{component:x.A,children:(0,g.jsxs)(R.A,{size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{sx:{bgcolor:"#f5f5f5"},children:[(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"User"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Role"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"School"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Credits Requested"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Current Credits"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Date"})}),(0,g.jsx)(M.A,{children:(0,g.jsx)("strong",{children:"Actions"})})]})}),(0,g.jsx)(L.A,{children:s.map(e=>(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:e.userName||e.userEmail}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.userRole,size:"small",color:"primary",variant:"outlined"})}),(0,g.jsx)(M.A,{children:e.schoolName||"-"}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:"+".concat(e.creditsRequested),size:"small",color:"success"})}),(0,g.jsx)(M.A,{children:e.currentCredits||0}),(0,g.jsx)(M.A,{children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"}),(0,g.jsxs)(M.A,{children:[(0,g.jsx)(I.A,{size:"small",color:"success",onClick:()=>n(e.id,!0),sx:{minWidth:32,mr:1},children:(0,g.jsx)(oe,{fontSize:"small"})}),(0,g.jsx)(I.A,{size:"small",color:"error",onClick:()=>n(e.id,!1),sx:{minWidth:32},children:(0,g.jsx)(ce.A,{fontSize:"small"})})]})]},e.id))})]})})})};var xe=n(97334),me=n(15136),ue=n(47968);const Ae=e=>{let{title:s,value:n,icon:t,color:l}=e;return(0,g.jsx)(d.A,{sx:{height:"100%"},children:(0,g.jsx)(h.A,{children:(0,g.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,g.jsxs)(a.A,{children:[(0,g.jsx)(i.A,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:s}),(0,g.jsx)(i.A,{variant:"h4",component:"div",children:n})]}),(0,g.jsx)(a.A,{sx:{color:l,opacity:.8},children:t})]})})})},je=e=>{let{accessToken:s}=e;const[n,t]=(0,r.useState)(null),[l,o]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{try{const e=await k.A.get("".concat("https://portal.myschoolct.com","/api/admin/dashboard-stats"),{headers:{Authorization:"Bearer ".concat(s)}});t(e.data)}catch(e){console.error("Error fetching stats:",e)}finally{o(!1)}})()},[s]),l?(0,g.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",minHeight:"200px"},children:(0,g.jsx)(xe.A,{})}):(0,g.jsxs)(a.A,{children:[(0,g.jsx)(i.A,{variant:"h6",sx:{mb:3},children:"Dashboard Analytics"}),(0,g.jsxs)(c.Ay,{container:!0,spacing:3,children:[(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,g.jsx)(Ae,{title:"Total Schools",value:(null===n||void 0===n?void 0:n.totalSchools)||0,icon:(0,g.jsx)(me.A,{sx:{fontSize:40}}),color:"#1976d2"})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,g.jsx)(Ae,{title:"Total Teachers",value:(null===n||void 0===n?void 0:n.totalTeachers)||0,icon:(0,g.jsx)(y,{sx:{fontSize:40}}),color:"#2e7d32"})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,g.jsx)(Ae,{title:"Total Students",value:(null===n||void 0===n?void 0:n.totalStudents)||0,icon:(0,g.jsx)(y,{sx:{fontSize:40}}),color:"#ed6c02"})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,g.jsx)(Ae,{title:"Total Downloads",value:(null===n||void 0===n?void 0:n.totalCreditsUsed)||0,icon:(0,g.jsx)(ue.A,{sx:{fontSize:40}}),color:"#9c27b0"})})]})]})};var pe=n(79266);const ge="https://portal.myschoolct.com",ve=e=>{let{accessToken:s}=e;const[n,t]=(0,r.useState)([]),[l,m]=(0,r.useState)(null),[u,A]=(0,r.useState)(!0),[j,p]=(0,r.useState)(0),[v,b]=(0,r.useState)(25),[y,f]=(0,r.useState)(0),[S,C]=(0,r.useState)("all"),[z,_]=(0,r.useState)(""),N=(0,r.useCallback)(async()=>{try{A(!0);const e=new URLSearchParams({skip:j*v,limit:v});"all"!==S&&e.append("action",S),z&&e.append("search",z);const n=await k.A.get("".concat(ge,"/api/admin/user-logs?").concat(e),{headers:{Authorization:"Bearer ".concat(s)}});t(n.data.logs||[]),f(n.data.total||0)}catch(e){console.error("Error fetching logs:",e)}finally{A(!1)}},[s,j,v,S,z]),w=(0,r.useCallback)(async()=>{try{const e=await k.A.get("".concat(ge,"/api/admin/user-logs/stats"),{headers:{Authorization:"Bearer ".concat(s)}});m(e.data)}catch(e){console.error("Error fetching stats:",e)}},[s]);(0,r.useEffect)(()=>{N(),w()},[N,w]);return(0,g.jsxs)(a.A,{children:[(0,g.jsx)(i.A,{variant:"h6",sx:{mb:3},children:"User Activity Logs"}),(0,g.jsxs)(c.Ay,{container:!0,spacing:2,sx:{mb:3},children:[(0,g.jsx)(c.Ay,{item:!0,xs:6,md:3,children:(0,g.jsx)(d.A,{children:(0,g.jsxs)(h.A,{children:[(0,g.jsx)(i.A,{color:"textSecondary",variant:"body2",children:"Today's Logins"}),(0,g.jsx)(i.A,{variant:"h5",children:(null===l||void 0===l?void 0:l.todayLogins)||0})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,md:3,children:(0,g.jsx)(d.A,{children:(0,g.jsxs)(h.A,{children:[(0,g.jsx)(i.A,{color:"textSecondary",variant:"body2",children:"Today's Downloads"}),(0,g.jsx)(i.A,{variant:"h5",children:(null===l||void 0===l?void 0:l.todayDownloads)||0})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,md:3,children:(0,g.jsx)(d.A,{children:(0,g.jsxs)(h.A,{children:[(0,g.jsx)(i.A,{color:"textSecondary",variant:"body2",children:"Total Actions"}),(0,g.jsx)(i.A,{variant:"h5",children:(null===l||void 0===l?void 0:l.totalActions)||0})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,md:3,children:(0,g.jsx)(d.A,{children:(0,g.jsxs)(h.A,{children:[(0,g.jsx)(i.A,{color:"textSecondary",variant:"body2",children:"Active Users (24h)"}),(0,g.jsx)(i.A,{variant:"h5",children:(null===l||void 0===l?void 0:l.activeUsers)||0})]})})})]}),(0,g.jsxs)(c.Ay,{container:!0,spacing:2,sx:{mb:2},children:[(0,g.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,g.jsx)(U.A,{fullWidth:!0,size:"small",label:"Search by name or email",value:z,onChange:e=>_(e.target.value)})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,md:3,children:(0,g.jsxs)(q.A,{fullWidth:!0,size:"small",children:[(0,g.jsx)(O.A,{children:"Action Type"}),(0,g.jsxs)(Q.A,{value:S,label:"Action Type",onChange:e=>C(e.target.value),children:[(0,g.jsx)(J.A,{value:"all",children:"All Actions"}),(0,g.jsx)(J.A,{value:"login",children:"Login"}),(0,g.jsx)(J.A,{value:"logout",children:"Logout"}),(0,g.jsx)(J.A,{value:"download",children:"Download"}),(0,g.jsx)(J.A,{value:"upload",children:"Upload"})]})]})})]}),(0,g.jsxs)(W.A,{component:x.A,children:[(0,g.jsxs)(R.A,{size:"small",children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:"Timestamp"}),(0,g.jsx)(M.A,{children:"User"}),(0,g.jsx)(M.A,{children:"Action"}),(0,g.jsx)(M.A,{children:"Details"}),(0,g.jsx)(M.A,{children:"IP Address"})]})}),(0,g.jsx)(L.A,{children:u?(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:5,align:"center",children:(0,g.jsx)(xe.A,{size:24})})}):0===n.length?(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:5,align:"center",children:"No logs found"})}):n.map((e,s)=>{return(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:new Date(e.timestamp).toLocaleString()}),(0,g.jsxs)(M.A,{children:[(0,g.jsx)(i.A,{variant:"body2",children:e.user||e.user_name||"Unknown"}),(0,g.jsx)(i.A,{variant:"caption",color:"textSecondary",children:e.email||e.user_email})]}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.action,size:"small",color:(n=e.action,{login:"success",logout:"default",download:"primary",upload:"secondary",delete:"error",update:"warning"}[n]||"default")})}),(0,g.jsx)(M.A,{children:e.details||"-"}),(0,g.jsx)(M.A,{children:e.ip_address||"-"})]},s);var n})})]}),(0,g.jsx)(pe.A,{component:"div",count:y,page:j,onPageChange:(e,s)=>p(s),rowsPerPage:v,onRowsPerPageChange:e=>{b(parseInt(e.target.value,10)),p(0)},rowsPerPageOptions:[10,25,50,100]})]})]})};var be=n(19042);const ye="https://portal.myschoolct.com",fe=e=>{let{accessToken:s}=e;const[n,l]=(0,r.useState)([]),[d,h]=(0,r.useState)(!0),[m,u]=(0,r.useState)(!1),[A,j]=(0,r.useState)(null),[p,v]=(0,r.useState)({name:"",description:"",price:"",credits:"",duration:"30",status:"DRAFT",features:""}),b=(0,r.useCallback)(async()=>{try{h(!0);const e=await k.A.get("".concat(ye,"/api/admin/sales-plans"),{headers:{Authorization:"Bearer ".concat(s)}});l(e.data.plans||[])}catch(e){console.error("Error fetching plans:",e)}finally{h(!1)}},[s]);(0,r.useEffect)(()=>{b()},[b]);const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(j(e),v({name:e.name||"",description:e.description||"",price:e.price||"",credits:e.credits||"",duration:e.duration||"30",status:e.status||"DRAFT",features:Array.isArray(e.features)?e.features.join(", "):""})):(j(null),v({name:"",description:"",price:"",credits:"",duration:"30",status:"DRAFT",features:""})),u(!0)};return(0,g.jsxs)(a.A,{children:[(0,g.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,g.jsx)(i.A,{variant:"h6",children:"Sales Plans"}),(0,g.jsx)(I.A,{variant:"contained",startIcon:(0,g.jsx)(B.A,{}),onClick:()=>y(),children:"Add New Plan"})]}),(0,g.jsx)(W.A,{component:x.A,children:(0,g.jsxs)(R.A,{children:[(0,g.jsx)(T.A,{children:(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:"Plan Code"}),(0,g.jsx)(M.A,{children:"Name"}),(0,g.jsx)(M.A,{children:"Price"}),(0,g.jsx)(M.A,{children:"Credits"}),(0,g.jsx)(M.A,{children:"Duration"}),(0,g.jsx)(M.A,{children:"Status"}),(0,g.jsx)(M.A,{children:"Actions"})]})}),(0,g.jsx)(L.A,{children:d?(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:7,align:"center",children:(0,g.jsx)(xe.A,{size:24})})}):0===n.length?(0,g.jsx)(P.A,{children:(0,g.jsx)(M.A,{colSpan:7,align:"center",children:"No sales plans found"})}):n.map(e=>{return(0,g.jsxs)(P.A,{children:[(0,g.jsx)(M.A,{children:e.planCode}),(0,g.jsx)(M.A,{children:e.name}),(0,g.jsxs)(M.A,{children:["\u20b9",e.price]}),(0,g.jsx)(M.A,{children:e.credits}),(0,g.jsxs)(M.A,{children:[e.duration," days"]}),(0,g.jsx)(M.A,{children:(0,g.jsx)(o.A,{label:e.status,size:"small",color:(n=e.status,{ACTIVE:"success",INACTIVE:"default",DRAFT:"warning",RETIRED:"error"}[n]||"default")})}),(0,g.jsxs)(M.A,{children:[(0,g.jsx)(G.A,{size:"small",onClick:()=>y(e),children:(0,g.jsx)(te.A,{})}),(0,g.jsx)(G.A,{size:"small",onClick:()=>(async e=>{try{const n="ACTIVE"===e.status?"INACTIVE":"ACTIVE";await k.A.patch("".concat(ye,"/api/admin/sales-plans/").concat(e.id,"/status"),{status:n},{headers:{Authorization:"Bearer ".concat(s)}}),b()}catch(n){console.error("Error updating status:",n)}})(e),children:(0,g.jsx)(be.A,{checked:"ACTIVE"===e.status,size:"small"})}),(0,g.jsx)(G.A,{size:"small",color:"error",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this plan?"))try{await k.A.delete("".concat(ye,"/api/admin/sales-plans/").concat(e),{headers:{Authorization:"Bearer ".concat(s)}}),b()}catch(n){console.error("Error deleting plan:",n)}})(e.id),children:(0,g.jsx)(le.A,{})})]})]},e.id);var n})})]})}),(0,g.jsxs)(K.A,{open:m,onClose:()=>u(!1),maxWidth:"sm",fullWidth:!0,children:[(0,g.jsx)(X.A,{children:A?"Edit Plan":"Add New Plan"}),(0,g.jsx)(Y.A,{children:(0,g.jsxs)(c.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Plan Name",value:p.name,onChange:e=>v((0,t.A)((0,t.A)({},p),{},{name:e.target.value}))})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,multiline:!0,rows:2,label:"Description",value:p.description,onChange:e=>v((0,t.A)((0,t.A)({},p),{},{description:e.target.value}))})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,children:(0,g.jsx)(U.A,{fullWidth:!0,type:"number",label:"Price (\u20b9)",value:p.price,onChange:e=>v((0,t.A)((0,t.A)({},p),{},{price:e.target.value}))})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,children:(0,g.jsx)(U.A,{fullWidth:!0,type:"number",label:"Credits",value:p.credits,onChange:e=>v((0,t.A)((0,t.A)({},p),{},{credits:e.target.value}))})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,children:(0,g.jsx)(U.A,{fullWidth:!0,type:"number",label:"Duration (days)",value:p.duration,onChange:e=>v((0,t.A)((0,t.A)({},p),{},{duration:e.target.value}))})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,children:(0,g.jsxs)(q.A,{fullWidth:!0,children:[(0,g.jsx)(O.A,{children:"Status"}),(0,g.jsxs)(Q.A,{value:p.status,label:"Status",onChange:e=>v((0,t.A)((0,t.A)({},p),{},{status:e.target.value})),children:[(0,g.jsx)(J.A,{value:"DRAFT",children:"Draft"}),(0,g.jsx)(J.A,{value:"ACTIVE",children:"Active"}),(0,g.jsx)(J.A,{value:"INACTIVE",children:"Inactive"})]})]})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Features (comma separated)",value:p.features,onChange:e=>v((0,t.A)((0,t.A)({},p),{},{features:e.target.value})),helperText:"e.g., Unlimited downloads, Priority support"})})]})}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:()=>u(!1),children:"Cancel"}),(0,g.jsx)(I.A,{variant:"contained",onClick:async()=>{try{const e=(0,t.A)((0,t.A)({},p),{},{price:parseFloat(p.price),credits:parseInt(p.credits),duration:parseInt(p.duration),features:p.features.split(",").map(e=>e.trim()).filter(e=>e)});A?await k.A.put("".concat(ye,"/api/admin/sales-plans/").concat(A.id),e,{headers:{Authorization:"Bearer ".concat(s)}}):await k.A.post("".concat(ye,"/api/admin/sales-plans"),e,{headers:{Authorization:"Bearer ".concat(s)}}),u(!1),b()}catch(e){console.error("Error saving plan:",e)}},children:"Save"})]})]})]})};var Se=n(66124);n(28769);const Ce=e=>{let{open:s,onClose:n,schoolForm:t,schoolFormErrors:l,onFormChange:r,onSubmit:a}=e;const i=(e,s)=>{r(e,s)};return(0,g.jsxs)(K.A,{open:s,onClose:n,maxWidth:"sm",fullWidth:!0,children:[(0,g.jsx)(X.A,{children:"Add New School"}),(0,g.jsxs)(Y.A,{children:[(0,g.jsxs)(c.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"School Name *",value:t.name,onChange:e=>i("name",e.target.value),error:!!l.name,helperText:l.name,inputProps:{maxLength:40}})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Admin Name *",value:t.adminName,onChange:e=>i("adminName",e.target.value),error:!!l.adminName,helperText:l.adminName,inputProps:{maxLength:40}})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Admin Email *",type:"email",value:t.adminEmail,onChange:e=>i("adminEmail",e.target.value),error:!!l.adminEmail,helperText:l.adminEmail,inputProps:{maxLength:30}})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Admin Phone *",value:t.adminPhone,onChange:e=>i("adminPhone",e.target.value.replace(/\D/g,"").slice(0,10)),error:!!l.adminPhone,helperText:l.adminPhone||"Must be exactly 10 digits",inputProps:{maxLength:10}})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"City",value:t.city,onChange:e=>i("city",e.target.value),error:!!l.city,helperText:l.city,inputProps:{maxLength:35}})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"State",value:t.state,onChange:e=>i("state",e.target.value),error:!!l.state,helperText:l.state,inputProps:{maxLength:35}})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Postal Code",value:t.postalCode,onChange:e=>i("postalCode",e.target.value.replace(/\D/g,"").slice(0,6)),inputProps:{maxLength:6}})})]}),(0,g.jsx)(Se.A,{sx:{mt:2},children:"* Required fields. Admin will receive login credentials via email."})]}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:n,children:"Cancel"}),(0,g.jsx)(I.A,{onClick:a,variant:"contained",disabled:!t.name||!t.adminEmail||!t.adminName||!t.adminPhone||Object.values(l).some(e=>e),sx:{bgcolor:"#ec4899","&:hover":{bgcolor:"#db2777"}},children:"Create School"})]})]})};var ze=n(39336);const _e={schools:{name:"Schools Template",mandatory:["school_name","admin_email","admin_name","mobile_number"],optional:["principal_name","address","city","state","postal_code"],sample:[{school_name:"ABC School",admin_email:"admin@abc.com",admin_name:"John Doe",mobile_number:"9876543210",principal_name:"Jane Smith",address:"123 Main St",city:"Mumbai",state:"Maharashtra",postal_code:"400001"}]},teachers:{name:"Teachers Template",mandatory:["name","email","mobile_number"],optional:["school_code","address","city","state","postal_code"],sample:[{name:"Teacher Name",email:"teacher@school.com",mobile_number:"9876543210",school_code:"SCH123456",address:"456 School Rd",city:"Delhi",state:"Delhi",postal_code:"110001"}],note:"Note: School code will be auto-filled with your school code if left blank."},students:{name:"Students Template",mandatory:["name","email","mobile_number","class_name"],optional:["school_code","teacher_code","section_name","roll_number","address","city","state","postal_code"],sample:[{name:"Student Name",email:"student@email.com",mobile_number:"9876543210",school_code:"SCH123456",teacher_code:"TCH001",class_name:"Class 5",section_name:"A",roll_number:"101"}],note:"Note: School code and Teacher code are required. Get these from Schools and Teachers tabs."}},Ne=e=>{var s,n,t,l,r;let{open:o,onClose:c,uploadType:d,uploadFile:h,uploading:x,uploadResults:m,onFileChange:u,onUpload:A,onDownloadTemplate:p}=e;const v=_e[d]||{};return(0,g.jsxs)(K.A,{open:o,onClose:c,maxWidth:"md",fullWidth:!0,children:[(0,g.jsxs)(X.A,{children:["Bulk Upload ",null===(s=v.name)||void 0===s?void 0:s.replace(" Template","s")]}),(0,g.jsxs)(Y.A,{children:[(0,g.jsxs)(a.A,{sx:{mb:3},children:[(0,g.jsx)(i.A,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Mandatory Fields:"}),(0,g.jsx)(i.A,{variant:"body2",sx:{mb:1},children:null===(n=v.mandatory)||void 0===n?void 0:n.join(", ")}),(0,g.jsx)(i.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,sx:{mt:2},children:"Optional Fields:"}),(0,g.jsx)(i.A,{variant:"body2",children:null===(t=v.optional)||void 0===t?void 0:t.join(", ")}),v.note&&(0,g.jsx)(j.A,{severity:"info",sx:{mt:2},children:v.note})]}),(0,g.jsx)(ze.A,{sx:{my:2}}),(0,g.jsx)(a.A,{sx:{mb:3},children:(0,g.jsxs)(I.A,{variant:"outlined",startIcon:(0,g.jsx)(ue.A,{}),onClick:()=>p(d),children:["Download ",v.name]})}),(0,g.jsxs)(a.A,{sx:{mb:2},children:[(0,g.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>u(e.target.files[0]),style:{display:"none"},id:"bulk-upload-input"}),(0,g.jsx)("label",{htmlFor:"bulk-upload-input",children:(0,g.jsx)(I.A,{variant:"contained",component:"span",startIcon:(0,g.jsx)(F,{}),sx:{bgcolor:"#ec4899","&:hover":{bgcolor:"#db2777"}},children:"Select File"})}),h&&(0,g.jsxs)(i.A,{variant:"body2",sx:{mt:1},children:["Selected: ",h.name]})]}),m&&(0,g.jsxs)(j.A,{severity:(null===(l=m.errors)||void 0===l?void 0:l.length)>0?"warning":"success",sx:{mt:2},children:[(0,g.jsxs)(i.A,{variant:"subtitle2",children:["Created: ",m.success_count||m.created||0]}),(null===(r=m.errors)||void 0===r?void 0:r.length)>0&&(0,g.jsxs)(a.A,{sx:{mt:1},children:[(0,g.jsx)(i.A,{variant:"subtitle2",children:"Errors:"}),m.errors.slice(0,5).map((e,s)=>(0,g.jsxs)(i.A,{variant:"body2",children:["Row ",e.row,": ",e.error]},s)),m.errors.length>5&&(0,g.jsxs)(i.A,{variant:"body2",children:["...and ",m.errors.length-5," more errors"]})]})]})]}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:c,children:"Close"}),(0,g.jsx)(I.A,{variant:"contained",onClick:A,disabled:x||!h,sx:{bgcolor:"#ec4899","&:hover":{bgcolor:"#db2777"}},children:x?(0,g.jsx)(xe.A,{size:24}):"Upload"})]})]})},ke=e=>{let{open:s,onClose:n,editingUser:t,editFormData:l,onFormChange:r,onSave:a}=e;return t?(0,g.jsxs)(K.A,{open:s,onClose:n,maxWidth:"sm",fullWidth:!0,children:[(0,g.jsxs)(X.A,{children:["Edit User: ",t.name]}),(0,g.jsx)(Y.A,{children:(0,g.jsxs)(c.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Name",value:l.name||"",onChange:e=>r("name",e.target.value)})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Email",value:l.email||"",onChange:e=>r("email",e.target.value)})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Mobile Number",value:l.mobileNumber||"",onChange:e=>r("mobileNumber",e.target.value.replace(/\D/g,"").slice(0,10))})}),"STUDENT"===t.role&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Ay,{item:!0,xs:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Class",value:l.className||"",onChange:e=>r("className",e.target.value)})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Section",value:l.sectionName||"",onChange:e=>r("sectionName",e.target.value)})}),(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Roll Number",value:l.rollNumber||"",onChange:e=>r("rollNumber",e.target.value)})})]}),(0,g.jsx)(c.Ay,{item:!0,xs:12,children:(0,g.jsx)(U.A,{fullWidth:!0,label:"Credits",type:"number",value:l.credits||0,onChange:e=>r("credits",parseInt(e.target.value)||0)})})]})}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:n,children:"Cancel"}),(0,g.jsx)(I.A,{onClick:a,variant:"contained",sx:{bgcolor:"#ec4899","&:hover":{bgcolor:"#db2777"}},children:"Save Changes"})]})]}):null},we=e=>{let{open:s,onClose:n,user:t,onConfirm:l}=e;return t?(0,g.jsxs)(K.A,{open:s,onClose:n,children:[(0,g.jsx)(X.A,{children:"Confirm Delete"}),(0,g.jsxs)(Y.A,{children:[(0,g.jsxs)(i.A,{children:["Are you sure you want to delete ",t.name," (",t.email,")?"]}),(0,g.jsx)(i.A,{variant:"body2",color:"error",sx:{mt:1},children:"This action cannot be undone."})]}),(0,g.jsxs)(Z.A,{children:[(0,g.jsx)(I.A,{onClick:n,children:"Cancel"}),(0,g.jsx)(I.A,{onClick:l,variant:"contained",color:"error",children:"Delete"})]})]}):null};var Ee=n(84645);const Ie=["children","value","index"],Ue="https://portal.myschoolct.com";function De(e){let{children:s,value:n,index:r}=e,i=(0,l.A)(e,Ie);return(0,g.jsx)("div",(0,t.A)((0,t.A)({role:"tabpanel",hidden:n!==r},i),{},{children:n===r&&(0,g.jsx)(a.A,{sx:{p:3},children:s})}))}const We=()=>{const{accessToken:e,userRole:s}=(0,N.d4)(e=>e.login),[n,l]=(0,r.useState)(0),{stats:p,schools:I,teachers:U,students:D,usersWithoutSchool:W,pendingImages:R,creditRequests:T,fetchStats:P,fetchSchools:M,fetchTeachers:L,fetchStudents:B,fetchUsersWithoutSchool:F,fetchPendingImages:H,fetchCreditRequests:q,fetchAllData:O}=E(e,s),{searchQuery:Q,setSearchQuery:J,searchResults:$,searchLoading:G,searchUsers:K}=(e=>{const[s,n]=(0,r.useState)(""),[t,l]=(0,r.useState)([]),[a,i]=(0,r.useState)(!1);return{searchQuery:s,setSearchQuery:n,searchResults:t,searchLoading:a,searchUsers:(0,r.useCallback)(async s=>{if(!s||s.length<2)l([]);else{i(!0);try{var n;const t=await k.A.get("".concat(w,"/api/rest/users/semantic-search?query=").concat(encodeURIComponent(s)),{headers:{Authorization:"Bearer ".concat(e)}});l((null===(n=t.data)||void 0===n?void 0:n.users)||t.data||[])}catch(r){try{var t;const n=await k.A.get("".concat(w,"/api/rest/users/search?query=").concat(encodeURIComponent(s)),{headers:{Authorization:"Bearer ".concat(e)}});l((null===(t=n.data)||void 0===t?void 0:t.users)||n.data||[])}catch(a){console.error("Search error:",a),l([])}}i(!1)}},[e])}})(e),[X,Y]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(!1),[se,ne]=(0,r.useState)(""),[te,le]=(0,r.useState)(null),[oe,ce]=(0,r.useState)(!1),[xe,me]=(0,r.useState)(null),[ue,Ae]=(0,r.useState)(!1),[pe,ge]=(0,r.useState)(null),[be,ye]=(0,r.useState)({}),[Se,ze]=(0,r.useState)(!1),[_e,Ie]=(0,r.useState)(null),[We,Re]=(0,r.useState)({name:"",adminEmail:"",adminName:"",adminPhone:"",city:"",state:"",postalCode:""}),[Te,Pe]=(0,r.useState)({}),[Me,Le]=(0,r.useState)({}),[Be,Fe]=(0,r.useState)({open:!1,message:"",severity:"success"});(0,r.useEffect)(()=>{O(),"SUPER_ADMIN"===s&&F()},[O,F,s]);const He=(e,s)=>{const n={name:{required:!0,maxLength:40},adminName:{required:!0,maxLength:40},adminEmail:{required:!0,maxLength:30,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},adminPhone:{required:!0,exactLength:10,pattern:/^\d{10}$/},city:{maxLength:35},state:{maxLength:35}}[e];if(!n)return"";if(n.required&&!s)return"This field is required";if(n.maxLength&&(null===s||void 0===s?void 0:s.length)>n.maxLength)return"Maximum ".concat(n.maxLength," characters");if(n.exactLength&&(null===s||void 0===s?void 0:s.length)!==n.exactLength)return"Must be exactly ".concat(n.exactLength," digits");if(n.pattern&&s&&!n.pattern.test(s)){if("adminEmail"===e)return"Invalid email format";if("adminPhone"===e)return"Must be 10 digits"}return""},Ve=e=>{ne(e),le(null),me(null),ee(!0)},qe=e=>{ge(e),ye({name:e.name,email:e.email,mobileNumber:e.mobileNumber,className:e.className,sectionName:e.sectionName,rollNumber:e.rollNumber,credits:e.credits||0}),Ae(!0)},Oe=async s=>{try{const n=!s.disabled;await k.A.post("".concat(Ue,"/api/rest/users/disableAccount"),{userId:s.id,disable:n},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"User ".concat(n?"disabled":"enabled"," successfully"),severity:"success"}),L(),B(),P()}catch(l){var n,t;Fe({open:!0,message:(null===(n=l.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.detail)||"Failed to update user status",severity:"error"})}};return(0,g.jsxs)(a.A,{sx:{p:{xs:1,sm:2,md:3},bgcolor:"#f5f5f5",minHeight:"100vh"},children:[(0,g.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:2},children:[(0,g.jsxs)(i.A,{variant:"h4",sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:["\ud83c\udf9b\ufe0f Admin Panel","SUPER_ADMIN"===s&&(0,g.jsx)(o.A,{label:"Super Admin",color:"primary",size:"small"}),"SCHOOL_ADMIN"===s&&(0,g.jsx)(o.A,{label:"School Admin",color:"secondary",size:"small"})]}),(0,g.jsx)(Ee.A,{showLabel:!0,size:"medium",refreshInterval:15e3})]}),(0,g.jsxs)(c.Ay,{container:!0,spacing:{xs:1,sm:2},sx:{mb:{xs:2,md:3}},children:[(0,g.jsx)(c.Ay,{item:!0,xs:6,sm:4,md:2,children:(0,g.jsx)(d.A,{sx:{bgcolor:"#e3f2fd",height:"100%"},children:(0,g.jsxs)(h.A,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[(0,g.jsx)(i.A,{variant:"h4",sx:{fontWeight:"bold",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:p.totalImages||0}),(0,g.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Total Images"})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,sm:4,md:2,children:(0,g.jsx)(d.A,{sx:{bgcolor:"#e8f5e9",height:"100%"},children:(0,g.jsxs)(h.A,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[(0,g.jsx)(i.A,{variant:"h4",sx:{fontWeight:"bold",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:p.totalUsers||0}),(0,g.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Total Users"})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,sm:4,md:2,children:(0,g.jsx)(d.A,{sx:{bgcolor:"#fff3e0",height:"100%"},children:(0,g.jsxs)(h.A,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[(0,g.jsx)(i.A,{variant:"h4",sx:{fontWeight:"bold",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:p.totalStudents||0}),(0,g.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Students"})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,sm:4,md:2,children:(0,g.jsx)(d.A,{sx:{bgcolor:"#fce4ec",height:"100%"},children:(0,g.jsxs)(h.A,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[(0,g.jsx)(i.A,{variant:"h4",sx:{fontWeight:"bold",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:p.totalTeachers||0}),(0,g.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Teachers"})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,sm:4,md:2,children:(0,g.jsx)(d.A,{sx:{bgcolor:"#e1f5fe",height:"100%"},children:(0,g.jsxs)(h.A,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[(0,g.jsx)(i.A,{variant:"h4",sx:{fontWeight:"bold",color:"success.main",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:p.activeUsers||0}),(0,g.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Active Users"})]})})}),(0,g.jsx)(c.Ay,{item:!0,xs:6,sm:4,md:2,children:(0,g.jsx)(d.A,{sx:{bgcolor:"#ffebee",height:"100%"},children:(0,g.jsxs)(h.A,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[(0,g.jsx)(i.A,{variant:"h4",sx:{fontWeight:"bold",color:"error.main",fontSize:{xs:"1.25rem",sm:"1.5rem",md:"2rem"}},children:p.disabledUsers||0}),(0,g.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Disabled Users"})]})})})]}),(0,g.jsxs)(x.A,{sx:{width:"100%",overflow:"hidden"},children:[(0,g.jsxs)(m.A,{value:n,onChange:(e,s)=>l(s),sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{minWidth:{xs:"auto",sm:80},fontSize:{xs:"0.65rem",sm:"0.75rem",md:"0.875rem"},p:{xs:"6px 8px",sm:"12px 16px"}}},variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:["SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(v,{sx:{fontSize:{xs:16,sm:20}}}),label:"Analytics"}),"SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(b,{sx:{fontSize:{xs:16,sm:20}}}),label:"Schools"}),"SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(y,{sx:{fontSize:{xs:16,sm:20}}}),label:"Users"}),"SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(f.A,{sx:{fontSize:{xs:16,sm:20}}}),label:"Images (".concat((null===R||void 0===R?void 0:R.length)||0,")")}),"SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(S,{sx:{fontSize:{xs:16,sm:20}}}),label:"Credits (".concat((null===T||void 0===T?void 0:T.length)||0,")")}),"SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(C.A,{sx:{fontSize:{xs:16,sm:20}}}),label:"User Logs"}),"SUPER_ADMIN"===s&&(0,g.jsx)(u.A,{icon:(0,g.jsx)(z,{sx:{fontSize:{xs:16,sm:20}}}),label:"Sales Plans"}),(0,g.jsx)(u.A,{icon:(0,g.jsx)(_,{sx:{fontSize:{xs:16,sm:20}}}),label:"Teachers"}),(0,g.jsx)(u.A,{icon:(0,g.jsx)(_,{sx:{fontSize:{xs:16,sm:20}}}),label:"Students"})]}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:0,children:(0,g.jsx)(je,{accessToken:e})}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:1,children:(0,g.jsx)(V,{schools:I,onAddSchool:()=>Y(!0),onBulkUpload:Ve})}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:2,children:(0,g.jsx)(ie,{usersWithoutSchool:W,bulkSchoolCodeUpdates:Me,onBulkSchoolCodeUpdate:async()=>{const s=Object.entries(Me).filter(e=>{let[s,n]=e;return n&&n.trim()}).map(e=>{let[s,n]=e;return{userId:s,schoolCode:n}});if(0!==s.length)try{await k.A.patch("".concat(Ue,"/api/rest/users/bulkUpdateSchoolCodes"),{updates:s},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"School codes updated successfully",severity:"success"}),Le({}),F()}catch(l){var n,t;Fe({open:!0,message:(null===(n=l.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.detail)||"Failed to update school codes",severity:"error"})}else Fe({open:!0,message:"No school codes to update",severity:"warning"})},onSchoolCodeChange:(e,s)=>Le(n=>(0,t.A)((0,t.A)({},n),{},{[e]:s}))})}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:3,children:(0,g.jsx)(de,{pendingImages:R,onApprove:async s=>{try{await k.A.post("".concat(Ue,"/api/rest/images/admin/approveImage"),{imageId:s},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"Image approved",severity:"success"}),H()}catch(n){Fe({open:!0,message:"Failed to approve image",severity:"error"})}},onReject:async s=>{try{await k.A.post("".concat(Ue,"/api/rest/images/admin/rejectImage"),{imageId:s},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"Image rejected",severity:"success"}),H()}catch(n){Fe({open:!0,message:"Failed to reject image",severity:"error"})}}})}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:4,children:(0,g.jsx)(he,{creditRequests:T,onApprove:async(s,n)=>{try{await k.A.post("".concat(Ue,"/api/rest/users/approveCreditRequest"),{requestId:s,approved:n},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"Credit request ".concat(n?"approved":"rejected"),severity:"success"}),q()}catch(t){Fe({open:!0,message:"Failed to process request",severity:"error"})}}})}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:5,children:(0,g.jsx)(ve,{accessToken:e})}),"SUPER_ADMIN"===s&&(0,g.jsx)(De,{value:n,index:6,children:(0,g.jsx)(fe,{accessToken:e})}),(0,g.jsx)(De,{value:n,index:"SUPER_ADMIN"===s?7:0,children:(0,g.jsx)(re,{teachers:U,userRole:s,searchQuery:Q,searchResults:$,searchLoading:G,onSearch:K,onSearchChange:J,onBulkUpload:Ve,onEditUser:qe,onDeleteUser:e=>{Ie(e),ze(!0)},onToggleStatus:Oe})}),(0,g.jsx)(De,{value:n,index:"SUPER_ADMIN"===s?8:1,children:(0,g.jsx)(ae,{students:D,userRole:s,searchQuery:Q,searchResults:$,searchLoading:G,onSearch:K,onSearchChange:J,onBulkUpload:Ve,onEditUser:qe,onDeleteUser:e=>{Ie(e),ze(!0)},onToggleStatus:Oe})})]}),(0,g.jsx)(Ce,{open:X,onClose:()=>Y(!1),schoolForm:We,schoolFormErrors:Te,onFormChange:(e,s)=>{Re(n=>(0,t.A)((0,t.A)({},n),{},{[e]:s})),Pe(n=>(0,t.A)((0,t.A)({},n),{},{[e]:He(e,s)}))},onSubmit:async()=>{const s={};if(Object.keys(We).forEach(e=>{const n=He(e,We[e]);n&&(s[e]=n)}),Object.keys(s).length>0)return Pe(s),void Fe({open:!0,message:"Please fix validation errors",severity:"error"});try{await k.A.post("".concat(Ue,"/api/rest/users/add"),{userRole:"SCHOOL_ADMIN",name:We.adminName,emailId:We.adminEmail,mobileNumber:We.adminPhone,schoolName:We.name,city:We.city,state:We.state,postalCode:We.postalCode},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"School created successfully!",severity:"success"}),Y(!1),Re({name:"",adminEmail:"",adminName:"",adminPhone:"",city:"",state:"",postalCode:""}),M(),P()}catch(l){var n,t;Fe({open:!0,message:(null===(n=l.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.detail)||"Failed to create school",severity:"error"})}}}),(0,g.jsx)(Ne,{open:Z,onClose:()=>ee(!1),uploadType:se,uploadFile:te,uploading:oe,uploadResults:xe,onFileChange:le,onUpload:async()=>{if(!te)return;ce(!0);const s=new FormData;s.append("file",te),s.append("type",se);try{const n=await k.A.post("".concat(Ue,"/api/admin/bulk-upload/").concat(se),s,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});me(n.data),Fe({open:!0,message:"Successfully uploaded ".concat(n.data.success_count||0," records"),severity:"success"}),"schools"===se?M():"teachers"===se?L():"students"===se&&B(),P()}catch(l){var n,t;Fe({open:!0,message:(null===(n=l.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.detail)||"Upload failed",severity:"error"})}ce(!1)},onDownloadTemplate:e=>{const s=({schools:["school_name*","admin_email*","admin_name*","mobile_number*","principal_name","address","city","state","postal_code"],teachers:["name*","email*","mobile_number*","school_code","address","city","state","postal_code"],students:["name*","email*","mobile_number*","school_code*","teacher_code*","class_name*","section_name","roll_number"]}[e]||[]).join(","),n=new Blob([s],{type:"text/csv"}),t=window.URL.createObjectURL(n),l=document.createElement("a");l.href=t,l.download="".concat(e,"_template.csv"),l.click()}}),(0,g.jsx)(ke,{open:ue,onClose:()=>Ae(!1),editingUser:pe,editFormData:be,onFormChange:(e,s)=>ye(n=>(0,t.A)((0,t.A)({},n),{},{[e]:s})),onSave:async()=>{try{await k.A.put("".concat(Ue,"/api/rest/users/manage"),(0,t.A)({action:"update",userId:pe.id},be),{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"User updated successfully",severity:"success"}),Ae(!1),L(),B()}catch(l){var s,n;Fe({open:!0,message:(null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.detail)||"Failed to update user",severity:"error"})}}}),(0,g.jsx)(we,{open:Se,onClose:()=>ze(!1),user:_e,onConfirm:async()=>{try{await k.A.put("".concat(Ue,"/api/rest/users/manage"),{action:"delete",userId:_e.id},{headers:{Authorization:"Bearer ".concat(e)}}),Fe({open:!0,message:"User deleted successfully",severity:"success"}),ze(!1),Ie(null),L(),B()}catch(t){var s,n;Fe({open:!0,message:(null===(s=t.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.detail)||"Failed to delete user",severity:"error"})}}}),(0,g.jsx)(A.A,{open:Be.open,autoHideDuration:6e3,onClose:()=>Fe(e=>(0,t.A)((0,t.A)({},e),{},{open:!1})),children:(0,g.jsx)(j.A,{severity:Be.severity,onClose:()=>Fe(e=>(0,t.A)((0,t.A)({},e),{},{open:!1})),children:Be.message})})]})}}}]);
//# sourceMappingURL=732.cfc9697d.chunk.js.map